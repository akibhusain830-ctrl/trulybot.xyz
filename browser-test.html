<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrulyBot Browser Compatibility Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
        }
        
        h1 {
            color: #2563eb;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: #f9fafb;
        }
        
        .test-section h2 {
            color: #374151;
            margin-top: 0;
        }
        
        .status {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.success {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #bbf7d0;
        }
        
        .status.warning {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }
        
        .status.error {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .test-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #1d4ed8;
        }
        
        button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .results {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .browser-info {
            background: #eff6ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2563eb;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .feature-item {
            display: flex;
            align-items: center;
            padding: 8px;
            background: white;
            border-radius: 4px;
            border: 1px solid #e5e7eb;
        }
        
        .feature-icon {
            margin-right: 10px;
            font-size: 18px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
                margin: 10px;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåê TrulyBot Browser Compatibility Test</h1>
        
        <div class="browser-info" id="browserInfo">
            <h3>üîç Browser Information</h3>
            <div id="browserDetails">Loading browser information...</div>
        </div>
        
        <div class="test-section">
            <h2>üß™ Automated Tests</h2>
            <p>Click the button below to run comprehensive browser compatibility tests:</p>
            <button onclick="runAllTests()" id="runTestsBtn">Run Compatibility Tests</button>
            <button onclick="clearResults()" id="clearBtn">Clear Results</button>
            <div class="results" id="testResults" style="display: none;"></div>
        </div>
        
        <div class="test-grid">
            <div class="test-card">
                <h3>üìù Form Testing</h3>
                <p>Test form inputs and validation:</p>
                <form id="testForm" onsubmit="testFormSubmission(event)">
                    <input type="email" placeholder="test@example.com" required style="width: 100%; margin: 5px 0; padding: 8px;">
                    <input type="tel" placeholder="+1234567890" style="width: 100%; margin: 5px 0; padding: 8px;">
                    <input type="date" style="width: 100%; margin: 5px 0; padding: 8px;">
                    <button type="submit">Test Form</button>
                </form>
                <div id="formResults"></div>
            </div>
            
            <div class="test-card">
                <h3>üé® CSS Features</h3>
                <p>Visual CSS feature tests:</p>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0;">
                    <div style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4); height: 50px; border-radius: 8px;"></div>
                    <div style="background: var(--test-color, #74b9ff); height: 50px; border-radius: 8px;"></div>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f1f3f4; border-radius: 4px;">
                    <span>Flexbox Test</span>
                    <span>‚úÖ</span>
                </div>
                <div id="cssResults"></div>
            </div>
            
            <div class="test-card">
                <h3>üì± Mobile Features</h3>
                <p>Touch and mobile-specific tests:</p>
                <div id="touchTest" style="background: #e3f2fd; padding: 20px; border-radius: 6px; text-align: center; margin: 10px 0; cursor: pointer;" 
                     onclick="testTouch()" ontouchstart="testTouch()">
                    Tap/Click me to test touch events
                </div>
                <button onclick="testDeviceFeatures()">Test Device Features</button>
                <div id="mobileResults"></div>
            </div>
            
            <div class="test-card">
                <h3>üåê Network Tests</h3>
                <p>API and network connectivity:</p>
                <button onclick="testLocalAPI()">Test Local API</button>
                <button onclick="testWebSocket()">Test WebSocket</button>
                <button onclick="testFetch()">Test Fetch API</button>
                <div id="networkResults"></div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>‚úÖ Manual Test Checklist</h2>
            <div class="feature-list">
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="Page loads correctly">
                    <span class="feature-icon">üìÑ</span>
                    Page loads correctly
                </label>
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="Navigation works">
                    <span class="feature-icon">üß≠</span>
                    Navigation works
                </label>
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="Images display properly">
                    <span class="feature-icon">üñºÔ∏è</span>
                    Images display properly
                </label>
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="Responsive design works">
                    <span class="feature-icon">üì±</span>
                    Responsive design works
                </label>
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="JavaScript executes">
                    <span class="feature-icon">‚ö°</span>
                    JavaScript executes
                </label>
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="Forms submit correctly">
                    <span class="feature-icon">üìù</span>
                    Forms submit correctly
                </label>
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="No console errors">
                    <span class="feature-icon">üêõ</span>
                    No console errors
                </label>
                <label class="feature-item">
                    <input type="checkbox" class="manual-test" data-feature="Performance acceptable">
                    <span class="feature-icon">‚ö°</span>
                    Performance acceptable
                </label>
            </div>
            <button onclick="generateReport()">Generate Test Report</button>
            <div id="manualResults"></div>
        </div>
    </div>

    <script src="browser-compatibility-test.js"></script>
    <script>
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            updateBrowserInfo();
            checkCSSFeatures();
        });
        
        function updateBrowserInfo() {
            const browser = detectBrowser();
            const info = document.getElementById('browserDetails');
            info.innerHTML = `
                <strong>Browser:</strong> ${browser.name}<br>
                <strong>Engine:</strong> ${browser.engine}<br>
                <strong>User Agent:</strong> ${navigator.userAgent}<br>
                <strong>Platform:</strong> ${navigator.platform}<br>
                <strong>Language:</strong> ${navigator.language}<br>
                <strong>Viewport:</strong> ${window.innerWidth}x${window.innerHeight}<br>
                <strong>Screen:</strong> ${window.screen.width}x${window.screen.height}
            `;
        }
        
        async function runAllTests() {
            const btn = document.getElementById('runTestsBtn');
            const results = document.getElementById('testResults');
            
            btn.disabled = true;
            btn.textContent = 'Running Tests...';
            results.style.display = 'block';
            results.textContent = 'Starting compatibility tests...\n';
            
            // Capture console output
            const originalLog = console.log;
            console.log = function(...args) {
                results.textContent += args.join(' ') + '\n';
                results.scrollTop = results.scrollHeight;
                originalLog.apply(console, args);
            };
            
            try {
                const testResults = await runBrowserCompatibilityTests();
                results.textContent += '\nüéâ Tests completed successfully!\n';
                results.textContent += `Final Score: ${testResults.compatibilityScore}%\n`;
            } catch (error) {
                results.textContent += `\n‚ùå Test error: ${error.message}\n`;
            }
            
            // Restore console
            console.log = originalLog;
            
            btn.disabled = false;
            btn.textContent = 'Run Compatibility Tests';
        }
        
        function clearResults() {
            document.getElementById('testResults').style.display = 'none';
            document.getElementById('testResults').textContent = '';
        }
        
        function testFormSubmission(event) {
            event.preventDefault();
            const results = document.getElementById('formResults');
            results.innerHTML = '<div class="status success">‚úÖ Form validation and submission working!</div>';
        }
        
        function checkCSSFeatures() {
            const results = document.getElementById('cssResults');
            let cssTests = [];
            
            if (CSS.supports('display', 'grid')) {
                cssTests.push('‚úÖ CSS Grid supported');
            } else {
                cssTests.push('‚ùå CSS Grid not supported');
            }
            
            if (CSS.supports('display', 'flex')) {
                cssTests.push('‚úÖ Flexbox supported');
            } else {
                cssTests.push('‚ùå Flexbox not supported');
            }
            
            if (CSS.supports('color', 'var(--test)')) {
                cssTests.push('‚úÖ CSS Variables supported');
            } else {
                cssTests.push('‚ùå CSS Variables not supported');
            }
            
            results.innerHTML = cssTests.map(test => `<div>${test}</div>`).join('');
        }
        
        function testTouch() {
            const results = document.getElementById('mobileResults');
            results.innerHTML = '<div class="status success">‚úÖ Touch/Click events working!</div>';
        }
        
        function testDeviceFeatures() {
            const results = document.getElementById('mobileResults');
            let deviceTests = [];
            
            if ('geolocation' in navigator) {
                deviceTests.push('‚úÖ Geolocation API available');
            } else {
                deviceTests.push('‚ùå Geolocation API not available');
            }
            
            if ('DeviceMotionEvent' in window) {
                deviceTests.push('‚úÖ Device Motion API available');
            } else {
                deviceTests.push('‚ùå Device Motion API not available');
            }
            
            if ('ontouchstart' in window) {
                deviceTests.push('‚úÖ Touch events available');
            } else {
                deviceTests.push('‚ö†Ô∏è Touch events not available (desktop?)');
            }
            
            results.innerHTML = deviceTests.map(test => `<div>${test}</div>`).join('');
        }
        
        async function testLocalAPI() {
            const results = document.getElementById('networkResults');
            try {
                const response = await fetch('/api/health');
                if (response.ok) {
                    results.innerHTML = '<div class="status success">‚úÖ Local API responding</div>';
                } else {
                    results.innerHTML = '<div class="status error">‚ùå Local API error: ' + response.status + '</div>';
                }
            } catch (error) {
                results.innerHTML = '<div class="status warning">‚ö†Ô∏è Local API not available (server not running?)</div>';
            }
        }
        
        function testWebSocket() {
            const results = document.getElementById('networkResults');
            if ('WebSocket' in window) {
                results.innerHTML = '<div class="status success">‚úÖ WebSocket API available</div>';
            } else {
                results.innerHTML = '<div class="status error">‚ùå WebSocket API not supported</div>';
            }
        }
        
        function testFetch() {
            const results = document.getElementById('networkResults');
            if ('fetch' in window) {
                results.innerHTML = '<div class="status success">‚úÖ Fetch API available</div>';
            } else {
                results.innerHTML = '<div class="status error">‚ùå Fetch API not supported</div>';
            }
        }
        
        function generateReport() {
            const checkedItems = document.querySelectorAll('.manual-test:checked');
            const totalItems = document.querySelectorAll('.manual-test').length;
            const passedTests = Array.from(checkedItems).map(item => item.dataset.feature);
            
            const report = `
                <div class="status ${checkedItems.length === totalItems ? 'success' : 'warning'}">
                    <h4>Manual Test Report</h4>
                    <p>Passed: ${checkedItems.length}/${totalItems} tests</p>
                    <p>Success Rate: ${Math.round((checkedItems.length / totalItems) * 100)}%</p>
                    ${passedTests.length > 0 ? '<p><strong>Passed Tests:</strong> ' + passedTests.join(', ') + '</p>' : ''}
                </div>
            `;
            
            document.getElementById('manualResults').innerHTML = report;
        }
        
        // Handle window resize
        window.addEventListener('resize', function() {
            updateBrowserInfo();
        });
    </script>
</body>
</html>